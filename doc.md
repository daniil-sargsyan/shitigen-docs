# Документация интеграции с 1С

## Пользователи
### Получить пользователя по GUID

* Запрос

```http request
GET {{API URL}}/user.get?filter[UF_USR_1722587885970]={{GUID}}
```

```{{GUID}}``` - GUID пользователя в 1C

---

* Ответ

```json
{
    "result": [
      {
        "ID": "99",
        "XML_ID": "",
        "ACTIVE": true,
        "NAME": "Name",
        "LAST_NAME": "Last Name",
        "SECOND_NAME": "",
        "TITLE": "",
        "EMAIL": "email@gmail.com"
      }
    ]
}
```

```result[0][ID]``` - ID пользователя в Битрикс24


## Контакты 

### Создать контакт

* Запрос

```http request
POST {{API_URL}}/crm.contact.add
```

```json
{
    "fields":{
        "NAME":"Անուն", 
        "LAST_NAME":"Ազգանուն", 
        "SECOND_NAME":"Հայրանուն",
        "PHONE" : [
            {"VALUE":"+37498888888"},
            {"VALUE":"+37498888888"}
            ], 
        "EMAIL":[
            {"VALUE":"test1@gmail.com"}, 
            {"VALUE":"test2@gmail.com"}
        ],
        "COMPANY":["62"], 
        "TYPE_ID":"UC_DIUN9M",
        "COMMENTS":"Մեկնաբանություն", 
        "ASSIGNED_BY_ID":"16", 
        "UF_CRM_1707822691457":[
            {"fileData":["test1.txt", "AA=="]},
            {"fileData":["test2.txt", "AA=="]}
        ],
        "UF_CRM_1723100443089":"GUID ID Contact",
        "UF_CRM_1723100456115":"CODE Contact "
    }
}

```
```NAME```: Անուն <br>
```LAST_NAME``` Ազգանուն  <br>
```SECOND_NAME``` Հայրանուն <br>
```PHONE```  Հեռախոսահամար <br>
```EMAIL``` E-mail <br>
```COMPANY``` Կազմակերպություն (массив с id компаний) <br>
```TYPE_ID``` Կոնտակտի տեսակ (возможные варианты "UC_JVEYP2" - Կոնտակտային անձ, "UC_DIUN9M" - Դիմորդ, "UC_KKSTDO" - Այլ, "" - Не Выбран) <br>
```COMMENTS``` Մեկնաբանություն <br>
```ASSIGNED_BY_ID``` Պատասխանատու (id пользователя) <br>
```UF_CRM_1707822691457``` Files (fileData должен быть массивом , который принимает массив [0] элементом которого является имя файла , [1] элементом файл в кодировке base64) <br>
```UF_CRM_1723100443089``` GUID ID Contact  <br>
```UF_CRM_1723100456115``` CODE Contact 1C  <br>

* Ответ

```json
{
    "result": 403,
    "time": {
        "start": 1723117855.28878,
        "finish": 1723117855.63746,
        "duration": 0.3486800193786621,
        "processing": 0.30963587760925293,
        "date_start": "2024-08-08T15:50:55+04:00",
        "date_finish": "2024-08-08T15:50:55+04:00"
    }
}
```

```result``` id созданного контакта


### Удалить контакт

```http request
GET {{API_URL}}/crm.contact.delete?ID={{ID}}
```

```{{ID}}``` - id контакта 

### Обновить контакт

* Запрос 

```http request
POST {{API_URL}}/crm.contact.update?ID={{ID}}
```

```{{ID}}``` - id контакта

```json
{
    "fields": {
        "NAME": "Անուն", 
        "LAST_NAME": "Ազգանուն", 
        "SECOND_NAME": "Հայրանուն", 
        "PHONE": [
            {
                "ID":"",
                "VALUE": "+37498888888"
            },
            {
                "ID":"",
                "VALUE": "+37498888889"
            }
        ], 
        "EMAIL": [
            {
                "ID":"",
                "VALUE": "test1@gmail.com"
            },
            {
                "ID":"",
                "VALUE": "test2@gmail.com"
            }
        ], 
        "UF_CRM_1721896329420": "Իրավաբանական հասցե", 
        "UF_CRM_1723108337023": "Գործունեության հասցե", 
        "UF_CRM_664DBFBD43D75": [
            "Կայանի տեղադրման հասցե 1",
            "Կայանի տեղադրման հասցե 2"
        ], 
        "UF_CRM_1707822379207": "Անձնագիր", 
        "UF_CRM_1707822426950": "2024-08-08T14:05:21+04:00", 
        "UF_CRM_1707822448806": "Ում կողմից", 
        "UF_CRM_1707822458574": "ՀԾՀ", 
        "UF_CRM_1707822731302": "464", 
        "UF_CRM_1707822585830": "Հ/Հ", 
        "COMPANY": [
            "62"
        ], 
        "TYPE_ID": "UC_DIUN9M",
        "COMMENTS": "Մեկնաբանություն", 
        "ASSIGNED_BY_ID": "16", 
        "UF_CRM_1707822691457": [
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ], 
        "UF_CRM_1723100443089": "GUID ID Contact", 
        "UF_CRM_1723100456115": "CODE Contact " 
    }
}
```

* Описание полей
```
Запрос

Во всех множественных полях по типу PHONE, EMAIL нужно добавлять ID если если нужно изменить конкретный элемент, если нет ID то добавится новый элемент.
чтобы получить их нужно сделать запрос {{API_URL}}/crm.contact.get?ID={{ID}} где {{ID}} это id контакта

Ответ

"result" true или false

```

## Компании

### Получить компанию по GUID\

```http request
POST {{API_URL}}/crm.company.list?filter[UF_CRM_1730300121246]={{GUID}}
```


### Создать компанию 

* Запрос

```http request
POST {{API_URL}}/crm.company.add
```

```json
{
    "fields":{
        "TITLE":"Կազմակերպության անվանում",
        "UF_CRM_1721909503670":"Աշխատանքային անվանում", 
        "PHONE" : [
            {"VALUE":"+37498888888"},
            {"VALUE":"+37498888889"}
            ], 
        "EMAIL":[
            {"VALUE":"test1@gmail.com"}, 
            {"VALUE":"test2@gmail.com"}
        ], 
        "UF_CRM_1721896430796": "Իրավաբանական հասցե", 
        "UF_CRM_1721896453819":"Գործունեության  հասցե", 
        "UF_CRM_1707823114526":"ՀՎՀՀ", 
        "UF_CRM_1707823136855":"259", 
        "UF_CRM_1707823142254":"Հ/Հ",
        "UF_CRM_1726221394609": "1123",
        "UF_CRM_66E7E0597FDF0": "address",
        "UF_CRM_1726221244784": "2024-08-21T14:44:27+04:00",
        "UF_CRM_1726221272809": "",
        "UF_CRM_1726221284926": "",
        "UF_CRM_664DBFBD53217":["Կայանի տեղադրման հասցե 1", "Կայանի տեղադրման հասցե 2"],  
        "CONTACT":["720"], 
        "COMMENTS":"COMMENTS", 
        "ASSIGNED_BY_ID":"16", 
        "UF_CRM_1707823223708":[
            {"fileData":["test1.txt", "AA=="]},
            {"fileData":["test2.txt", "AA=="]}
        ],
        "UF_CRM_1723100322669":"CODE Company",
        "UF_CRM_1723100288587":"GUID ID Company"
    }
}
```

```TITLE``` Հաճախորդի անվանում <br>
```UF_CRM_1721909503670``` Աշխատանքային անվանում <br>
```PHONE``` Հեռախոսահամար <br>
```EMAIL``` E-mail <br>

```UF_CRM_1726221394609```: Հաճախորդի տեսակը <br>
```UF_CRM_66E7E0597FDF0```: Տեղադրման հասցե․ <br>

```UF_CRM_1721896430796``` Իրավաբանական հասցե <br>
```UF_CRM_1721896453819``` Գործունեության  հասցե <br>
```UF_CRM_1707823114526``` ՀՎՀՀ/Անձնագիր <br>
```UF_CRM_1707823136855```: Բանկ (варианты можно получить сделав запрос {{API_URL}}/crm.contact.fields) <br>
```UF_CRM_1707823142254``` Հ/Հ <br>
```UF_CRM_664DBFBD53217```: Կայանի տեղադրման հասցե  <br>
```CONTACT``` : Contact (id контакта) <br>
```COMMENTS``` : Մեկնաբանություն  <br>
```ASSIGNED_BY_ID```: Պատասխանտու (id пользователя) <br>
```UF_CRM_1707823223708```: Files (fileData должен быть массивом , который принимает массив [0] элементом которого является имя файла , [1] элементом файл в кодировке base64) <br>
```UF_CRM_1723100322669```: CODE Company 1C <br>
```UF_CRM_1723100288587```: GUID ID Company <br>


* Ответ
```json
{
    "result": 404,
    "time": {
        "start": 1723122634.834688,
        "finish": 1723122635.047344,
        "duration": 0.21265602111816406,
        "processing": 0.18756604194641113,
        "date_start": "2024-08-08T17:10:34+04:00",
        "date_finish": "2024-08-08T17:10:35+04:00"
    }
}
```

```result``` id созданной компании

### Удалить компанию 

```http request
GET {{API_URL}}/crm.company.delete?ID={{ID}}
```

```{{ID}}``` - id компании


### Обновить компанию

```http request
POST {{API_URL}}/crm.company.update?ID={{ID}}
```
```{{ID}}``` - id компании


* Запрос

```json
{
    "fields":{
        "TITLE":"Կազմակերպության անվանում",
        "UF_CRM_1721909503670":"Աշխատանքային անվանում", 
        "PHONE" : [
            {
              "ID":"9999",
              "VALUE":"+37498888888"
            },
            {
              "ID":"9999",
              "VALUE":"+37498888889"
            }
            ], 
        "EMAIL":[
            {
              "ID":"9999",
              "VALUE":"test1@gmail.com"
            }, 
            {
              "ID":"9999",
              "VALUE":"test2@gmail.com"
            }
        ], 
        "UF_CRM_1721896430796": "Իրավաբանական հասցե", 
        "UF_CRM_1721896453819":"Գործունեության  հասցե", 
        "UF_CRM_1707823114526":"ՀՎՀՀ", 
        "UF_CRM_1707823136855":"259", 
        "UF_CRM_1707823142254":"Հ/Հ", 
        "UF_CRM_664DBFBD53217":["Կայանի տեղադրման հասցե 1", "Կայանի տեղադրման հասցե 2"],  
        "CONTACT":["720"], 
        "COMMENTS":"COMMENTS", 
        "ASSIGNED_BY_ID":"16", 
        "UF_CRM_1707823223708":[
            {"fileData":["test1.txt", "AA=="]},
            {"fileData":["test2.txt", "AA=="]}
        ],
        "UF_CRM_1723100322669":"CODE Company",
        "UF_CRM_1723100288587":"GUID ID Company"
    }
}
```

* Комментарии
```
Запрос

Во всех множественных полях по типу PHONE, EMAIL нужно добавлять ID если нужно изменить конкретный элемент, если нет ID то добавится новый элемент.
чтобы получить их нужно сделать запрос {{API_URL}}/crm.company.get?ID={{ID}} где {{ID}} это id контакта

Ответ

"result" true или false

```

## Сделки

### Создать сделку

* Запрос

```http request
POST {{API_URL}}/crm.deal.add
```

```json
{
    "FIELDS": {
        "CONTACT_IDS":[16,752],
        "COMPANY_ID":404,
        "CATEGORY_ID": "23", 
        "UF_CRM_65C0DDB1DC035": "690", 
        "UF_CRM_1720615831": "2141", 
        "ASSIGNED_BY_ID": "1658", 
        "UF_CRM_1723478338": "1658", 
        "UF_CRM_1723456013427": {
            "fileData": [
                "test2.txt",
                "AA=="
            ]
        }, 
        "UF_CRM_65C0DDB25FDCC": "716", 
        "UF_CRM_65C0DDB2731A8": "758",
        "UF_CRM_1707146945": "1658", 
        "UF_CRM_1721644324534": "Տեղադրման հասցե", 
        "UF_CRM_1707142118301": 123, 
        "UF_CRM_1707142129557": "2024-08-21T14:44:27+04:00", 
        "UF_CRM_1723728819249": "2024-08-21T14:44:27+04:00", 
        "UF_CRM_1710754283945": [
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ], 
        "UF_CRM_1721212689069": [
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ], 
        "UF_CRM_1724228626835": {
            "fileData": [
                "test2.txt",
                "AA=="
            ]
        },  
        "UF_CRM_1721212947817": [
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ], 
        "UF_CRM_1721226683917": {
            "fileData": [
                "test2.txt",
                "AA=="
            ]
        }, 
        "UF_CRM_1721227146412": [
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ], 
        "UF_CRM_1719840037394": [
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ], 
        "UF_CRM_1724228786967": {
            "fileData": [
                "test2.txt",
                "AA=="
            ]
        },
        "UF_CRM_1723731868551": "Վաճառքի ստորաբաժանում", 
        "UF_CRM_65DEDE67DDA89": "1658", 
        "UF_CRM_65DEDE67CFBC8": "1658", 
        "COMMENTS": "COMMENTS", 
        "DATE_CREATE": "2024-08-21T14:44:27+04:00", 
        "SOURCE_ID": "", 
        "UF_CRM_65C0DDB23246D": "704",
        "UF_CRM_1707141560319": 123, 
        "UF_CRM_1707141691014": 124, 
        "UF_CRM_1707141709398": 125,
        "UF_CRM_1707148088": "2175",
        "UF_CRM_1727716217601": "",
        "UF_CRM_1730298017862": 123,
        "UF_CRM_1730298033857": 123,
        "UF_CRM_1720711718169":"2175",
        "UF_CRM_1720712020590":"2181",
        "UF_CRM_1720712054873":"2179",
        "UF_CRM_1720718399041":"2024-08-21T14:44:27+04:00",
        "UF_CRM_1720712745822":"2180",
        "UF_CRM_1721059538003":["2187","2188"],
        "UF_CRM_1720718543737":"2024-08-21T14:44:27+04:00",
        "UF_CRM_1721212030884":"2024-08-21T14:44:27+04:00",
        "UF_CRM_1721212391118":"2189",
        "UF_CRM_1721212855006":"2190",
        "UF_CRM_1721227862456":["2192", "2193"],
        "UF_CRM_1721229192845":"2196",
        "UF_CRM_1721230730533":"2199",
        "UF_CRM_1721291174605":"2203",
        "UF_CRM_1727946771": [
          {
            "fileData": [
              "test1.txt",
              "AA=="
            ]
          },
          {
            "fileData": [
              "test2.txt",
              "AA=="
            ]
          }
        ],
        "UF_CRM_1723720209915":[
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ],
        "UF_CRM_1723720239081":[
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ],
        "UF_CRM_1723720263387":[
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ],
        "UF_CRM_1723720287231":[
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ],
        "UF_CRM_1723720307362":[
            {
                "fileData": [
                    "test1.txt",
                    "AA=="
                ]
            },
            {
                "fileData": [
                    "test2.txt",
                    "AA=="
                ]
            }
        ],
        "UF_CRM_1724230664105":"guid1",
        "UF_CRM_1724231394244":"guid2",
        "UF_CRM_1724231444254":"guid3",
        "UF_CRM_1724231490893":"guid4",
        "UF_CRM_1724231543965":"guid5",
        "UF_CRM_1724231582932":"guid6",
        "UF_CRM_1724231622957":"guid7",
        "UF_CRM_1724231651955":"guid8"
    }
}
```

ՀԱՃԱԽՈՐԴԻ ՏՎՅԱԼՆԵՐ<br>
```CONTACT_IDS```:  Հաճախորդ contact <br>
```COMPANY_ID```: Հաճախորդ company  <br>
```CATEGORY_ID```: 23- PV - մանրածախ, 26- PV - կորպորատիվ  <br>
```UF_CRM_65C0DDB1DC035```:Տեղադրման մարզ  <br>
```UF_CRM_1720615831```: Բնակավայր  <br>
```ASSIGNED_BY_ID```: Վաճառող չափագրող (պատասխանատու)*  <br>
```UF_CRM_1723478338```: Չափագրող (Разметчик)*  <br>
```UF_CRM_1723456013427```: Չափագրման հայտ  <br>
```UF_CRM_65C0DDB25FDCC```: Վճարման տեսակը* <br>
```UF_CRM_65C0DDB2731A8```: Կազմակերպություն  <br>

ՏԵՂԱԴՐՈՒՄ <br>
```UF_CRM_1707146945```: Տեղադրող ինժեներ  <br>
```UF_CRM_1721644324534```: Տեղադրման հասցե*  <br>
```UF_CRM_1707142118301```: Տեղադրման օրերի քանակ  <br>
```UF_CRM_1707142129557```: Տեղադրման վերջնաժամկետ  <br>
```UF_CRM_1723728819249```: Տեղադրման փաստացի ամսաթիվ  <br>
```UF_CRM_1710754283945```: Տեղադրման նկարներ  <br>
```UF_CRM_1721212689069```: PV ակտ  <br>
```UF_CRM_1724228626835```: PV ակտ (ստորագրված)  <br>
```UF_CRM_1721212947817```: Պահեստ / տեղադրող ակտ  <br>
```UF_CRM_1721226683917```: Պահեստ / տեղադրող ակտ (ստորագրված) <br> 
```UF_CRM_1721227146412```: Երաշխիքի կտրոն  <br>
```UF_CRM_1727946771```   : Գնառաջարկ (վերջնական) <br>
```UF_CRM_1719840037394```: Պայմանագիր  <br>
```UF_CRM_1724228786967```: Ստորագրված պայմանագիր  <br>


ԼՐԱՑՈՒՑԻՉ ԻՆՖՈՐՄԱՑԻԱ <br>
```UF_CRM_1723731868551```: Վաճառքի ստորաբաժանում  <br>
```UF_CRM_65DEDE67DDA89```: Վաճառքի համակարգող  <br>

```UF_CRM_1707148088``` : Վաճառքի բաժնի ղեկավար <br> -----------------

```UF_CRM_65DEDE67CFBC8```: Նախագծող*  <br>
```COMMENTS```: Մեկնաբանություն   <br>
```UF_CRM_1730298033857``` : Պատվերից ստացած վճար <br>
```UF_CRM_1727716217601``` : Ստուգում (Производства) <br>
```UF_CRM_1730298017862``` : Պատվերի արժեք <br>
```DATE_CREATE```: Գործարքի տեղծման ամսաթիվ  <br>
```SOURCE_ID```: Աղբյուր  <br>
```UF_CRM_65C0DDB23246D```: Մերժման պատճառը  <br>



ՏՎՅԱԼՆԵՐ
```UF_CRM_1720711718169```: Заявка <br>
```UF_CRM_1720712020590```: Смета <br>
```UF_CRM_1720712054873```: Заказ клиента <br>
```UF_CRM_1720718399041```: Желаемая дата отгрузки (Заказ клиента) <br>
```UF_CRM_1720712745822```: Заказ на перемещение <br>
```UF_CRM_1721059538003```: Заказ на перемещение (Обеспечение) <br>
```UF_CRM_1720718543737```: Желаемая дата поступления (Заказ на перемещение) <br>
```UF_CRM_1721212030884```: Дата поступления (Заказ на перемещение) <br>
```UF_CRM_1721212391118```: Перемещение товаров <br>
```UF_CRM_1721212855006```: Расходный ордер <br>
```UF_CRM_1721227862456```: Производства (files) <br>
```UF_CRM_1721229192845```: Производства (Состояние трудозатраты) <br>
```UF_CRM_1721230730533```: Производства (Состояние производства) <br>
```UF_CRM_1721291174605```: Реализация товаров и услуг <br>

ՉԱՓԱԳՐՄԱՆ ՆԿԱՐՆԵՐ <br>

```UF_CRM_1723720209915```: Տունը կամ շինությունը հեռվից (ընդհանուր տեսքը) <br>
```UF_CRM_1723720239081```: Տանիքը կամ տանիքները վրայից և տակից (եթե շատ են համարակալել)  <br>
```UF_CRM_1723720263387```: Փոփոխական հոսանքի միացման տեղը <br>
```UF_CRM_1723720287231```: Փոխակերպիչի տեղադրման տեղը  <br>
```UF_CRM_1723720307362```: Հողանցման տեղը  <br>

Փաստաթղթերի GUID  <br>
```UF_CRM_1724230664105```: Заявка GUID <br>
```UF_CRM_1724231394244```: Смета GUID <br>
```UF_CRM_1724231444254```: Заказ клиента GUID <br>
```UF_CRM_1724231490893```: Заказ на перемещение GUID <br>
```UF_CRM_1724231543965```: Перемещение товаров GUID  <br>
```UF_CRM_1724231582932```: Расходный ордер GUID <br>
```UF_CRM_1724231622957```: Производства GUID <br>
```UF_CRM_1724231651955```: Реализация товаров и услуг GUID <br>


* Комментарии
```
Чтобы получить возможные значения полей list сделайте запрос {{API_URL}}/crm.deal.fields
```


* Ответ
```json
  {
    "result": 394,
    "time":  {
      "start": 1724316052.682712,
      "finish": 1724316053.930977,
      "duration": 1.248265027999878,
      "processing": 1.226294994354248,
      "date_start": "2024-08-22T12:40:52+04:00",
      "date_finish": "2024-08-22T12:40:53+04:00"
    }
  }
```


### Удалить сделку

* Запрос

```http request
GET {{API_URL}}/crm.deal.delete?id={{ID}}
```
```{{ID}}``` - id сделки

### Обновить сделку

* Запрос

```http request
POST {{API_URL}}/crm.deal.update?id={{ID}}
```
```{{ID}}``` - id сделки

* Комментарии 

```Логика полей такая же как и в предыдущих блоках```


### Получить сделку по id

* Запрос

```http request
GET {{API_URL}}/crm.deal.get?id={{ID}}
```
```{{ID}}``` - id сделки
